language: python

python:
  - 3.5
 # - pypy3
  
git:
  submodules: false

build:
  #pre_ci:
    #- docker build -t=shippabledocker/sample_node:june1 .   
    
 # pre_ci_boot:
   # image_name: drydock/u16pytall
   # image_tag: master
   # pull: true
   # options: '--privileged=true --net=bridge -e FOO=true -e BOO=false' 

  ci:
    - pip install -r requirements.txt
    - mkdir -p shippable/testresults
    - mkdir -p shippable/codecoverage
    - which python
    - pip install -e . && nosetests
    - coverage run `which nosetests` test.py --with-xunit --xunit-file=shippable/testresults/nosetests.xml
    - coverage xml -o shippable/codecoverage/coverage.xml
    - echo JobId=$JOB_ID
    - echo JobTriggerByName="$JOB_TRIGGERED_BY_NAME"
    - echo JobTriggerById="$JOB_TRIGGERED_BY_ID" 
    - echo PULL_REQUEST_REPO_FULL_NAME="$PULL_REQUEST_REPO_FULL_NAME"
    - export PULL_REQUEST_IS_FORK=$(eval echo "$"$PULL_REQUEST_REPO_FULL_NAME"_IS_FORK")
    - echo PULL_REQUEST_IS_FORK=$PULL_REQUEST_IS_FORK
    
  cache: true
